<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="js/src/jquery.js"></script>

    <script>
        $(function () {

            /***
             * 有鱼计划-总查询
             ****/
            function getSearchList(page){

                var fishPlanName = $("#fishPlanName").val();
                var deadLine = $("#deadLine").val();
                var status = $("#status").val();
                var startTime = $("#startTime").val();
                var endTime = $("#endTime").val();
                //var pageNum =  createPage(p);

                $.ajax({
                    url:thisPath + "/yyjh/listFishPlan.html",
                    type: 'post',
                    dataType:'json',
                    data: {
                        'fishPlanName':fishPlanName,
                        'deadLine':deadLine,
                        'status':status,
                        'startTime':startTime,
                        'endTime':endTime,
                        'pageNum':page
                    },
                    success: function(result) {

                        //根据返回JSON-重新渲染页面
                        if(result.result<=0){
                            alert('未找到数据！');
                        }else{
                            var myTemplate = Handlebars.compile($("#Js-yyjh-list-controller").html());
                            $('#Js-YYJH-list').html(myTemplate(result));

                        }
                    },
                    error: function(result) {
                        onError(result);
                    }
                });
                return false;
            }

//分页方法

            function createPage(pagenum,totalPage){

                $(".tcdPageCode").createPage({
                    pageCount:totalPage,
                    current:pagenum,
                    backFn:function(p){
                        //单击回调方法，p是当前页码
                        getSearchList(p);
                    }
                });

            }


            function getYYJHList(result) {
                //渲染方法
                var myTemplate = Handlebars.compile($("#Js-StatisticsPage-controller").html());
                $('#tableList').html(myTemplate(result));
            }
            /***
             * 有鱼计划-有鱼计划列表-筛选搜索
             ****/
            $(".Js-jh-search").click(function(){
                $.ajax({
                    url:thisPath + "/yyjh/listFishPlan.html",
                    type: 'post',
                    dataType:'json',
                    data: $("#jh-search-form").serialize(),
                    success: function(result) {
                        //$("#jh-search-form input").val("");
                        //console.log(result);
                        if(result.result<=0){
                            alert('未找到数据！');
                        }else{
                            var myTemplate = Handlebars.compile($("#Js-StatisticsPage-controller").html());
                            $('#tableList').html(myTemplate(result));
                            //getYYJHList(result);
                        }
                    },
                    error: function(result) {
                        alert('失败');
                    }
                });
                return false;
            });

        })
    </script>
</head>
<body>

</body>
</html>